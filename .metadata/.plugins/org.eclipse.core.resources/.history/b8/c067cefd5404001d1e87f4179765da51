package com.consume;

import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.core.ParameterizedTypeReference;
import org.springframework.http.HttpMethod;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.model.Customer;

@RestController
@RequestMapping("serv2")
public class Caller {

	Caller()
	{
		System.out.println("caller const------------------------------");
	}
	
	
	@Autowired
	private RestTemplate restt;
	@GetMapping(value="/getCustomerCaller1",produces = MediaType.APPLICATION_JSON_VALUE)
	public @ResponseBody Map<Long,Customer> getCustomer1()
	{

	 Map m=new HashMap();
	 Customer c=new Customer();
	 c.setId(1);
	 c.setName("gg");
	 c.setAddress("gdv");
	 c.setAge(20);
		
	 Customer c1=new Customer();
	 c1.setId(2);
	 c1.setName("gg");
	 c1.setAddress("gdv");
	 c1.setAge(20);
	 
	 m.put(1, c);
	 m.put(2,c1);
	 
		
	      
	 return m;
	}

 @GetMapping(value="/getCustomerCaller",produces = MediaType.APPLICATION_JSON_VALUE)
 public @ResponseBody Map getCustomer(@RequestParam String id) throws JsonMappingException, JsonProcessingException
	{
	System.out.println("call getcustomer caller-------------------------------"+id);
	
	//Map allCustomers=restt.getForObject("http://localhost:8084/serv1/getCustomer",Map.class);
	
	ResponseEntity result = restt.getForEntity("http://localhost:8084/serv1/getCustomer", Map.class);
  
	
	return allCustomers;
		
	}
	
	
	
}
